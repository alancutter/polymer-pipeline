<!DOCTYPE html>
<html>
<head>
  <script src="components/platform/platform.js"></script>
  <link rel="import" href="elements/pl-canvas.html">
  <link rel="import" href="elements/pl-number.html">
  <link rel="import" href="elements/pl-html-visualizer.html">
  <style>
    #visBox {
      width: 1400px;
      height: 1000px;
      overflow: hidden;
      background-color: #EFE;
      -webkit-user-select: none;
    }

    #visBox pl-html-visualizer {
      width: 100px;
      height: 50px;
      font-size: 10px;
    }

    #phat {
      width: 300px;
    }
  </style>
</head>
<body>
<div id='visBox'>
  <pl-html-visualizer name="source" x='10' y='10'>
    <pl-point-source></pl-point-source>
  </pl-html-visualizer>
  <pl-html-visualizer name="slider" x='10' y='200'>
    <pl-slider></pl-slider>
    <input type='range'></input>
  </pl-html-visualizer>
  <pl-html-visualizer name="encircle" x='200' y='10'>
    <pl-encircle id='n1'></pl-encircle>
  </pl-html-visualizer>
  <pl-html-visualizer name="slider" x='200' y='200'>
    <pl-slider id='r2'></pl-slider>
    <input type='range' id='r2r'></input>
  </pl-html-visualizer>
  <pl-html-visualizer name="encircle" x='400' y='10'>
    <pl-encircle id='n2'></pl-encircle>
  </pl-html-visualizer>
  <pl-html-visualizer name="slider" x='400' y='200'>
    <pl-slider id='r3'></pl-slider>
    <input type='range' id='r3r'></input>
  </pl-html-visualizer>
  <pl-html-visualizer name="encircle" x='600' y='10'>
    <pl-encircle id='n3'></pl-encircle>
  </pl-html-visualizer>
  <pl-html-visualizer name="canvas" x='750' y='10' id='phat'>
    <pl-canvas-sink></pl-canvas-sink>
    <canvas width='300px' height='300px' id='output'></canvas>
  </pl-html-visualizer>
</div>
</body>
<script>
var pointSource = document.querySelector('pl-point-source');
var canvasSink = document.querySelector('pl-canvas-sink');
var slider = document.querySelector('pl-slider');
canvasSink.addEventListener('ready', function() {
  setTimeout(function() {
    canvasSink.context = document.querySelector('#output').getContext('2d');
    n1.in = pointSource.out;
    n2.in = n1.out;
    n3.in = n2.out;
    n1.width = slider.out;
    n2.width = r2.out;
    slider.slider = document.querySelector('input');
    r2.slider = document.querySelector('#r2r');
    n3.width = r3.out;
    r3.slider = document.querySelector('#r3r');
    canvasSink.in = n3.out;
    setTimeout(function() {
      pointSource.points = [{x:100, y:100}, {x:200, y:100}, {x:100, y:200}, 
                            {x:200, y:200}]}, 100);
  }, 100);
});
</script>
</html>
